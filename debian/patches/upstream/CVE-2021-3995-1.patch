From 9c05f4b6bf62a20a64a8e5735c7f3dcf0229e895 Mon Sep 17 00:00:00 2001
From: Karel Zak <kzak@redhat.com>
Date: Tue, 18 Jan 2022 12:30:11 +0100
Subject: [PATCH] lib/strutils: make sure mem2strcpy() buffer is zeroized

Let's make the function robust for work with strings and uninitialized
buffers.

Reported-by: Sean Anderson <seanga2@gmail.com>
Signed-off-by: Karel Zak <kzak@redhat.com>
---
 include/strutils.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/include/strutils.h
+++ b/include/strutils.h
@@ -106,8 +106,8 @@ static inline char *mem2strcpy(char *des
 	if (n + 1 > nmax)
 		n = nmax - 1;
 
+	memset(dest, '\0', nmax);
 	memcpy(dest, src, n);
-	dest[nmax-1] = '\0';
 	return dest;
 }
 
